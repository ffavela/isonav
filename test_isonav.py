from isonav import main
from docopt import DocoptExit
from pytest import raises
import io
from contextlib import redirect_stdout


def test_help():
    usageStr = """Usage:
  isonav <number> [-v] (-s|--symbol)
  isonav <symbol> [-v] ([-p|--protons])
  isonav <symbol> [-v] (--name)
  isonav <iso> [-v] [-n|--neutrons] [[-i|--isotopes] [-m --amu]]
  isonav <iso> [-v] ([-m|--mass]|--compton) [--amu --liquidDrop]
  isonav <iso> [-v] --mirror
  isonav <iso> [-v] ([-r | --radius]|[(-l|--levels) [--limit=val]])
  isonav <iso> [-v] --Elab=val (--deBroglie | --redDeBroglie)
  isonav <iso> [-v] --Elab=val --L4TOF=L
  isonav <iso> [-v] --decay [--Ex=val]
  isonav <iso> [-v] (--alpha | --nEmission | --pEmission ) [--num=val]
  isonav <iso> [-v] --Emission=val [--num=val]
  isonav <iso> [-v] (--BE | --BEperNucleon) [--liquidDrop]
  isonav <iso1> <iso2> [-v] (--coulomb | --reactions [--latex] )
  isonav <iso1> <iso2> [-v] (--gamowEnergy | --T=temp --gamowPeak )
  isonav <iso1> <iso2> [-v] --fussion [--Elab=val]
  isonav <iso1> <iso2> [-v] --Elab=val --angle=val [[--xTreme|-x] --latex]
  isonav <iso1> <iso2> [-v] --scatE=val --angle=val
  isonav <isop> <isot> <isoEject> <isoRes> [-v] (-q|--QVal) [--amu]
  isonav <isop> <isot> <isoEject> <isoRes> [-v] --Elab=val --maxAng
  isonav <isop> <isot> <isoEject> <isoRes> [-v] --Elab=val --angle=val ([--xEje=val] [--xRes=val])
  isonav <isop> <isot> <isoEject> <isoRes> [-v] --Elab=val --angle=val [(-x|--xTreme) [--xF1=xFileEject.txt] [--xF2=xFileRes.txt]]
  isonav <ion> [-v] --material=matName --Elab=val (--thickness=val [--depositedE] | --range) [--bloch] [--density=dens]
  isonav [-v] --listMaterials [--material=matName]
  isonav -h | --version
"""
    with raises(DocoptExit):
        isoHelpOutput = main([])
        assert isoHelpOutput == usageStr


def get_output(argv):
    f = io.StringIO()
    with redirect_stdout(f):
        main(argv)
    return f.getvalue().rstrip('\n')


def test_symbols():
    argv = ['-s', '22']
    out = get_output(argv)
    assert 'Ti' == out
    #Put more here


def test_protons():
    argv = ['--protons', 'Au']
    out = get_output(argv)
    assert '79' == out
    argv = ['--protons', 'Ag']
    out = get_output(argv)
    assert '47' == out
    # Put more here


def test_neutrons():
    argv = ['--neutrons', '195Au']
    out = get_output(argv)
    assert '116' == out
    # Put more here


def test_isotopes():
    argv = ['-i', 'Pb']
    out = get_output(argv)
    isos = """178Pb
179Pb
180Pb
181Pb
182Pb
183Pb
184Pb
185Pb
186Pb
187Pb
188Pb
189Pb
190Pb
191Pb
192Pb
193Pb
194Pb
195Pb
196Pb
197Pb
198Pb
199Pb
200Pb
201Pb
202Pb
203Pb
204Pb
205Pb
206Pb
207Pb
208Pb
209Pb
210Pb
211Pb
212Pb
213Pb
214Pb
215Pb
216Pb
217Pb
218Pb
219Pb
220Pb"""
    assert isos == out


def test_isomasses():
    argv = ['-im', 'Au', '--amu']
    out = get_output(argv)
    iso_masses = """169Au\t168.99808
170Au\t169.995972
171Au\t170.991875791
172Au\t171.989942284
173Au\t172.986240924
174Au\t173.984717
175Au\t174.981303712
176Au\t175.980250432
177Au\t176.976870439
178Au\t177.97603192
179Au\t178.973173654
180Au\t179.972523397
181Au\t180.970079047
182Au\t181.969617874
183Au\t182.967590635
184Au\t183.967451524
185Au\t184.965789569
186Au\t185.965952703
187Au\t186.964543155
188Au\t187.965349392
189Au\t188.963948286
190Au\t189.96469839
191Au\t190.963702248
192Au\t191.964813694
193Au\t192.964137257
194Au\t193.965417754
195Au\t194.965035225
196Au\t195.966569908
197Au\t196.966568786
198Au\t197.96824242
199Au\t198.968765282
200Au\t199.970756456
201Au\t200.971657484
202Au\t201.973856
203Au\t202.975154446
204Au\t203.977831
205Au\t204.97985
206Au\t205.98474
207Au\t206.9884
208Au\t207.99345
209Au\t208.99735
210Au\t210.0025"""
    assert iso_masses == out


def test_some_masses():
    argv = ['--mass', '22Ne']
    out = get_output(argv)
    assert '20484.845484518828' == out


def test_LDM_mass():
    argv = ['--mass', '--liquidDrop', '22Ne']
    out = get_output(argv)
    assert '20477.90454623588' == out

def test_mirror():
    argv = ['--mirror', '22Ne']
    out = get_output(argv)
    assert '22Mg' == out


def test_nucl_radius():
    argv = ['-r', '40Ca']
    out = get_output(argv)
    assert '4.103942272024073' == out


def test_nucl_levels():
    argv = ['--levels', '--limit', '10', '12C']
    out = get_output(argv)
    expLevs = """1\t0.0
2\t4.43891
3\t7.6541999999999994
4\t9.641
5\t10.3
6\t10.844
7\t11.16
8\t11.828
9\t12.71
10\t13.352"""
    assert expLevs == out


def test_redDeBroglie():
    argv = ['--Elab', '2.0', '--redDeBroglie', '12C']
    out = get_output(argv)
    assert '9.332022523394577e-06' == out


def test_simple_reaction():
    argv = ['--Elab', '3.0', '--angle', '35',
            'd', '14N', 'a', '12C']
    out = get_output(argv)
    expOut = """4He\t12C
13.929\t-130.521\t2.645

12C\t4He
5.881\t-132.566\t10.693"""
    assert expOut == out


def test_xTreme_reaction():
    argv = ['--Elab', '3.0', '--angle', '35',
            '--xTreme', 'd', '14N', 'a', '12C']
    out = get_output(argv)
    expOut = """*4He\t12C
1\t0.000\t\t13.929\t-130.521\t2.645

4He\t*12C
1\t0.000\t\t13.929\t-130.521\t2.645
2\t4.439\t\t10.341\t-127.323\t1.794
3\t7.654\t\t7.710\t-123.304\t1.210
4\t9.641\t\t6.061\t-119.175\t0.872
5\t10.300\t\t5.509\t-117.282\t0.765
6\t10.844\t\t5.051\t-115.418\t0.679
7\t11.160\t\t4.784\t-114.177\t0.630
8\t11.828\t\t4.216\t-111.055\t0.531
9\t12.710\t\t3.456\t-105.431\t0.408
10\t13.352\t\t2.896\t-99.612\t0.326
11\t14.083\t\t2.245\t-89.914\t0.246
12\t15.110\t\t1.293\t-65.497\t0.171
13\t15.440\t\t0.969\t-53.181\t0.166
14\t16.106\t\t0.198\t-16.445\t0.271

14\t16.106\t\t0.003\t-1.617\t0.465

*12C\t4He
1\t0.000\t\t5.881\t-132.566\t10.693
2\t4.439\t\t4.507\t-130.226\t7.628
3\t7.654\t\t3.478\t-127.424\t5.442
4\t9.641\t\t2.819\t-124.675\t4.114
5\t10.300\t\t2.595\t-123.450\t3.679
6\t10.844\t\t2.407\t-122.262\t3.323
7\t11.160\t\t2.297\t-121.480\t3.118
8\t11.828\t\t2.060\t-119.539\t2.687
9\t12.710\t\t1.737\t-116.108\t2.127
10\t13.352\t\t1.493\t-112.597\t1.729
11\t14.083\t\t1.200\t-106.670\t1.291
12\t15.110\t\t0.737\t-89.285\t0.728
13\t15.440\t\t0.556\t-77.047\t0.578

12\t15.110\t\t0.000\t-0.625\t1.464
13\t15.440\t\t0.016\t-6.794\t1.118

12C\t*4He
1\t0.000\t\t5.881\t-132.566\t10.693"""
    assert expOut == out


def test_reactions():
    argv = ['--reactions', 'd', '14N']
    out = get_output(argv)
    expOut = """0None\t16O\tNone\t20.74\tNone
4He\t12C\t0.00\t13.57\t3.71
1H\t15N\t0.00\t8.61\t2.42
8Be\t8Be\t0.00\t6.12\t4.80
1n\t15O\t0.00\t5.07\t0.00
2H\t14N\t0.00\t0.00\t2.29
3He\t13C\t2.35\t-2.06\t3.80
3H\t13N\t4.91\t-4.30\t2.21
5Li\t11B\t4.97\t-4.35\t4.58
5He\t11C\t6.73\t-5.88\t3.66
6Li\t10B\t11.60\t-10.14\t4.53
7Be\t9Be\t12.72\t-11.12\t4.81
7Li\t9B\t12.95\t-11.32\t4.51
6Be\t10Be\t17.14\t-14.98\t4.83
6He\t10C\t19.78\t-17.29\t3.63
4Li\t12B\t25.95\t-22.69\t4.64
4H\t12N\t29.69\t-25.96\t2.17
8Li\t8B\t31.87\t-27.87\t4.50
3Li\t13B\t33.42\t-29.23\t4.74
9Li\t7B\t41.89\t-36.63\t4.51
7He\t9C\t44.58\t-38.98\t3.61
5H\t11N\t47.10\t-41.20\t2.14
5Be\t11Be\t47.24\t-41.32\t4.88
8He\t8C\t57.94\t-50.67\t3.60
10Li\t6B\t73.59\t-64.37\t4.53
6H\t10N\t73.93\t-64.68\t2.12"""
    assert expOut == out


def test_coulomb_excitations():
    argv = ['--Elab', '5.5', '--angle', '25',
            '--xTreme', 'd', '14N', 'd', '14N']
    out = get_output(argv)
    expOut = """*2H\t14N
1\t0.000\t\t5.354\t-75.758\t0.146
2\t2.225\t\t3.116\t-45.059\t0.160

2H\t*14N
1\t0.000\t\t5.354\t-75.758\t0.146
2\t2.313\t\t3.024\t-43.689\t0.163
3\t3.948\t\t1.267\t-19.738\t0.285

*14N\t2H
1\t0.000\t\t1.987\t-123.078\t3.513
2\t2.313\t\t1.342\t-108.138\t1.845
3\t3.948\t\t0.513\t-51.516\t1.039

2\t2.313\t\t0.063\t-9.113\t3.124
3\t3.948\t\t0.481\t-48.333\t1.071

14N\t*2H
1\t0.000\t\t1.987\t-123.078\t3.513
2\t2.225\t\t1.371\t-109.124\t1.905

2\t2.225\t\t0.057\t-8.519\t3.219"""
    assert expOut == out


def test_fussion_examples():
    argv = ['--fussion', 'p', '14N']
    out = get_output(argv)
    expOut = """15O\t7\t7.276\t0.021"""
    assert expOut == out
    argv = ['--fussion', '--Elab', '0.1',
            '-v', 'p', '14N']
    out = get_output(argv)
    expOut = """#Prints the fused element, if isotope exists.
#Max populated level, and energy, and remaining KE in lab
15O\t7\t7.276\t0.121"""
    assert expOut == out


def test_reactions_no_specified_exit_channel():
    argv = ['--Elab', '3.0', '--angle', '35', 'd', '14N']
    out = get_output(argv)
    expOut = """4He\t12C
13.929\t-130.521\t2.645

12C\t4He
5.881\t-132.566\t10.693

1H\t15N
11.351\t-99.191\t0.257

15N\t1H
1.576\t-118.695\t10.032

8Be\t8Be
5.910\t-128.846\t3.205

8Be\t8Be
5.910\t-128.846\t3.205

1n\t15O
7.896\t-84.863\t0.176

15O\t1n
1.197\t-112.642\t6.875

2H\t14N
2.848\t-70.134\t0.152

14N\t2H
0.885\t-101.910\t2.115

3He\t13C
0.772\t-35.903\t0.171

13C\t3He
0.280\t-50.709\t0.663

0.143\t-30.168\t0.800"""
    assert expOut == out


def test_reactions_no_specified_exit_channel_xTreme():
    argv = ['--Elab', '3.0', '--angle', '35',
            '--xTreme', 'd', '14N']
    out = get_output(argv)
    expOut = """*4He\t12C
1\t0.000\t\t13.929\t-130.521\t2.645

4He\t*12C
1\t0.000\t\t13.929\t-130.521\t2.645
2\t4.439\t\t10.341\t-127.323\t1.794
3\t7.654\t\t7.710\t-123.304\t1.210
4\t9.641\t\t6.061\t-119.175\t0.872
5\t10.300\t\t5.509\t-117.282\t0.765
6\t10.844\t\t5.051\t-115.418\t0.679
7\t11.160\t\t4.784\t-114.177\t0.630
8\t11.828\t\t4.216\t-111.055\t0.531
9\t12.710\t\t3.456\t-105.431\t0.408
10\t13.352\t\t2.896\t-99.612\t0.326
11\t14.083\t\t2.245\t-89.914\t0.246
12\t15.110\t\t1.293\t-65.497\t0.171
13\t15.440\t\t0.969\t-53.181\t0.166
14\t16.106\t\t0.198\t-16.445\t0.271

14\t16.106\t\t0.003\t-1.617\t0.465

*12C\t4He
1\t0.000\t\t5.881\t-132.566\t10.693
2\t4.439\t\t4.507\t-130.226\t7.628
3\t7.654\t\t3.478\t-127.424\t5.442
4\t9.641\t\t2.819\t-124.675\t4.114
5\t10.300\t\t2.595\t-123.450\t3.679
6\t10.844\t\t2.407\t-122.262\t3.323
7\t11.160\t\t2.297\t-121.480\t3.118
8\t11.828\t\t2.060\t-119.539\t2.687
9\t12.710\t\t1.737\t-116.108\t2.127
10\t13.352\t\t1.493\t-112.597\t1.729
11\t14.083\t\t1.200\t-106.670\t1.291
12\t15.110\t\t0.737\t-89.285\t0.728
13\t15.440\t\t0.556\t-77.047\t0.578

12\t15.110\t\t0.000\t-0.625\t1.464
13\t15.440\t\t0.016\t-6.794\t1.118

12C\t*4He
1\t0.000\t\t5.881\t-132.566\t10.693

*1H\t15N
1\t0.000\t\t11.351\t-99.191\t0.257

1H\t*15N
1\t0.000\t\t11.351\t-99.191\t0.257
2\t5.270\t\t6.190\t-73.974\t0.148
3\t5.299\t\t6.162\t-73.766\t0.148
4\t6.324\t\t5.148\t-65.626\t0.137
5\t7.155\t\t4.321\t-57.981\t0.133
6\t7.301\t\t4.175\t-56.542\t0.133
7\t7.567\t\t3.909\t-53.840\t0.132
8\t8.313\t\t3.160\t-45.778\t0.136
9\t8.571\t\t2.899\t-42.819\t0.139
10\t9.050\t\t2.413\t-37.143\t0.146
11\t9.152\t\t2.309\t-35.897\t0.148
12\t9.155\t\t2.305\t-35.860\t0.148
13\t9.222\t\t2.237\t-35.034\t0.150
14\t9.760\t\t1.683\t-28.224\t0.166
15\t9.829\t\t1.611\t-27.323\t0.169
16\t9.925\t\t1.511\t-26.056\t0.173
17\t10.066\t\t1.363\t-24.167\t0.180
18\t10.450\t\t0.956\t-18.789\t0.203
19\t10.533\t\t0.865\t-17.552\t0.210
20\t10.693\t\t0.690\t-15.084\t0.225
21\t10.702\t\t0.681\t-14.945\t0.226
22\t10.804\t\t0.567\t-13.263\t0.238

*15N\t1H
1\t0.000\t\t1.576\t-118.695\t10.032
2\t5.270\t\t0.992\t-107.610\t5.347
3\t5.299\t\t0.988\t-107.507\t5.322
4\t6.324\t\t0.857\t-103.138\t4.428
5\t7.155\t\t0.742\t-98.203\t3.711
6\t7.301\t\t0.721\t-97.143\t3.587
7\t7.567\t\t0.681\t-95.001\t3.361
8\t8.313\t\t0.557\t-86.937\t2.739
9\t8.571\t\t0.508\t-82.976\t2.529
10\t9.050\t\t0.399\t-72.124\t2.160
11\t9.152\t\t0.369\t-68.577\t2.088
12\t9.155\t\t0.368\t-68.460\t2.086
13\t9.222\t\t0.345\t-65.571\t2.041

4\t6.324\t\t0.002\t-2.659\t5.283
5\t7.155\t\t0.013\t-6.788\t4.441
6\t7.301\t\t0.016\t-7.674\t4.292
7\t7.567\t\t0.022\t-9.465\t4.019
8\t8.313\t\t0.052\t-16.233\t3.244
9\t8.571\t\t0.068\t-19.591\t2.969
10\t9.050\t\t0.117\t-28.997\t2.442
11\t9.152\t\t0.134\t-32.158\t2.323
12\t9.155\t\t0.135\t-32.263\t2.319
13\t9.222\t\t0.149\t-34.880\t2.237

15N\t*1H
1\t0.000\t\t1.576\t-118.695\t10.032

*8Be\t8Be
1\t0.000\t\t5.910\t-128.846\t3.205
2\t3.040\t\t4.101\t-124.235\t1.975

8Be\t*8Be
1\t0.000\t\t5.910\t-128.846\t3.205
2\t3.040\t\t4.102\t-124.233\t1.974

*8Be\t8Be
1\t0.000\t\t5.910\t-128.846\t3.205
2\t3.040\t\t4.101\t-124.235\t1.975

8Be\t*8Be
1\t0.000\t\t5.910\t-128.846\t3.205
2\t3.040\t\t4.102\t-124.233\t1.974

*1n\t15O
1\t0.000\t\t7.896\t-84.863\t0.176

1n\t*15O
1\t0.000\t\t7.896\t-84.863\t0.176
2\t5.183\t\t2.749\t-41.116\t0.141
3\t5.241\t\t2.690\t-40.433\t0.141
4\t6.176\t\t1.732\t-28.855\t0.164
5\t6.793\t\t1.084\t-20.531\t0.195
6\t6.859\t\t1.013\t-19.582\t0.199
7\t7.276\t\t0.557\t-13.128\t0.239
8\t7.556\t\t0.226\t-7.547\t0.290

*15O\t1n
1\t0.000\t\t1.197\t-112.642\t6.875
2\t5.183\t\t0.478\t-80.290\t2.411
3\t5.241\t\t0.466\t-79.106\t2.365

2\t5.183\t\t0.080\t-21.882\t2.810
3\t5.241\t\t0.085\t-22.900\t2.746

15O\t*1n
1\t0.000\t\t1.197\t-112.642\t6.875

*2H\t14N
1\t0.000\t\t2.848\t-70.134\t0.152
2\t2.225\t\t0.570\t-21.267\t0.205

2H\t*14N
1\t0.000\t\t2.848\t-70.134\t0.152
2\t2.313\t\t0.468\t-18.499\t0.220

*14N\t2H
1\t0.000\t\t0.885\t-101.910\t2.115

14N\t*2H
1\t0.000\t\t0.885\t-101.910\t2.115

*3He\t13C
1\t0.000\t\t0.772\t-35.903\t0.171

3He\t*13C
1\t0.000\t\t0.772\t-35.903\t0.171

*13C\t3He
1\t0.000\t\t0.280\t-50.709\t0.663

1\t0.000\t\t0.143\t-30.168\t0.800

13C\t*3He
1\t0.000\t\t0.280\t-50.709\t0.663

1\t0.000\t\t0.143\t-30.168\t0.800"""
    assert expOut == out


def test_decay():
    argv = ['--decay', '235U']
    out = get_output(argv)
    expOut = """76Zn\t159Sm\t\t111.947\t53.485\t165.431
77Zn\t158Sm\t\t110.923\t54.037\t164.960
75Zn\t160Sm\t\t111.483\t52.232\t163.714
74Zn\t161Sm\t\t111.932\t51.417\t163.349
73Zn\t162Sm\t\t111.038\t50.006\t161.044
72Zn\t163Sm\t\t110.853\t48.933\t159.786
75Cu\t160Eu\t\t108.181\t50.692\t158.872
74Cu\t161Eu\t\t108.753\t49.966\t158.718
73Cu\t162Eu\t\t109.351\t49.252\t158.603
76Cu\t159Eu\t\t106.871\t51.069\t157.940
72Cu\t163Eu\t\t109.153\t48.190\t157.343
71Cu\t164Eu\t\t109.562\t47.404\t156.965
77Cu\t158Eu\t\t105.355\t51.333\t156.688
70Ni\t165Gd\t\t109.985\t46.635\t156.620
72Ni\t163Gd\t\t108.537\t47.923\t156.461
71Zn\t164Sm\t\t109.137\t47.215\t156.352
71Ni\t164Gd\t\t108.953\t47.148\t156.101
69Ni\t166Gd\t\t109.811\t45.618\t155.429
73Ni\t162Gd\t\t107.074\t48.234\t155.308
68Ni\t167Gd\t\t110.311\t44.887\t155.197
74Ni\t161Gd\t\t106.120\t48.762\t154.882
78Cu\t157Eu\t\t103.475\t51.401\t154.876
70Cu\t165Eu\t\t108.557\t46.025\t154.582
70Zn\t165Sm\t\t108.359\t45.935\t154.294
69Cu\t166Eu\t\t108.513\t45.072\t153.586
75Ni\t160Gd\t\t104.249\t48.858\t153.108
67Ni\t168Gd\t\t109.420\t43.607\t153.027
79Cu\t156Eu\t\t101.505\t51.399\t152.904
76Ni\t159Gd\t\t102.232\t48.859\t151.091
66Ni\t169Gd\t\t108.673\t42.407\t151.080
68Cu\t167Eu\t\t106.882\t43.488\t150.370
80Cu\t155Eu\t\t98.387\t50.781\t149.169
69Co\t166Tb\t\t105.245\t43.729\t148.973
67Co\t168Tb\t\t106.511\t42.454\t148.965
68Co\t167Tb\t\t105.737\t43.035\t148.771
70Co\t165Tb\t\t104.210\t44.196\t148.406
77Ni\t158Gd\t\t99.747\t48.610\t148.357
66Co\t169Tb\t\t106.206\t41.452\t147.658
71Co\t164Tb\t\t102.852\t44.516\t147.367
65Co\t170Tb\t\t106.237\t40.592\t146.830
66Fe\t169Dy\t\t105.431\t41.155\t146.586
64Fe\t171Dy\t\t106.313\t39.766\t146.079
78Ni\t157Gd\t\t97.455\t48.418\t145.873
65Fe\t170Dy\t\t105.491\t40.314\t145.806
67Fe\t168Dy\t\t104.063\t41.486\t145.549
72Co\t163Tb\t\t100.787\t44.512\t145.300
64Co\t171Tb\t\t105.345\t39.399\t144.744
68Fe\t167Dy\t\t102.822\t41.855\t144.677
63Fe\t172Dy\t\t105.828\t38.737\t144.565
81Cu\t154Eu\t\t94.657\t49.791\t144.448
62Fe\t173Dy\t\t105.836\t37.901\t143.737
73Co\t162Tb\t\t98.921\t44.571\t143.492
69Fe\t166Dy\t\t100.709\t41.853\t142.562
79Ni\t156Gd\t\t93.706\t47.459\t141.165
74Co\t161Tb\t\t96.494\t44.350\t140.844
70Fe\t165Dy\t\t98.893\t41.949\t140.842
82Cu\t153Eu\t\t91.115\t48.842\t139.957
63Mn\t172Ho\t\t101.963\t37.329\t139.291
62Mn\t173Ho\t\t102.159\t36.592\t138.752
64Mn\t171Ho\t\t100.740\t37.689\t138.429
61Mn\t174Ho\t\t102.457\t35.896\t138.353
65Mn\t170Ho\t\t99.931\t38.196\t138.127
71Fe\t164Dy\t\t96.229\t41.659\t137.887
75Co\t160Tb\t\t93.858\t43.998\t137.856
60Mn\t175Ho\t\t102.107\t34.984\t137.091
66Mn\t169Ho\t\t98.147\t38.321\t136.469
60Cr\t175Er\t\t101.347\t34.729\t136.076
58Cr\t177Er\t\t102.161\t33.453\t135.613
62Cr\t173Er\t\t99.739\t35.731\t135.470
59Cr\t176Er\t\t101.453\t33.990\t135.443
72Fe\t163Dy\t\t93.918\t41.486\t135.404
61Cr\t174Er\t\t100.209\t35.116\t135.325
76Co\t159Tb\t\t91.032\t43.518\t134.550
67Mn\t168Ho\t\t96.008\t38.283\t134.292
63Cr\t172Er\t\t97.444\t35.683\t133.127
64Cr\t171Er\t\t96.129\t35.971\t132.099
73Fe\t162Dy\t\t90.798\t40.920\t131.718
68Mn\t167Ho\t\t93.451\t38.050\t131.500
57V\t178Tm\t\t97.925\t31.340\t129.265
65Cr\t170Er\t\t93.330\t35.682\t129.012
58V\t177Tm\t\t96.954\t31.756\t128.709
56V\t179Tm\t\t98.003\t30.641\t128.644
69Mn\t166Ho\t\t90.788\t37.738\t128.527
74Fe\t161Dy\t\t87.833\t40.378\t128.211
59V\t176Tm\t\t95.965\t32.158\t128.122
54Ti\t181Yb\t\t98.299\t29.307\t127.606
55Ti\t180Yb\t\t97.433\t29.755\t127.188
56Ti\t179Yb\t\t96.491\t30.173\t126.663
60V\t175Tm\t\t94.190\t32.285\t126.474
66Cr\t169Er\t\t90.886\t35.493\t126.379
61V\t174Tm\t\t92.775\t32.518\t125.293
70Mn\t165Ho\t\t87.788\t37.248\t125.036
57Ti\t178Yb\t\t94.296\t30.186\t124.482
58Ti\t177Yb\t\t92.662\t30.356\t123.017
62V\t173Tm\t\t90.295\t32.357\t122.651
67Cr\t168Er\t\t87.495\t34.897\t122.392
71Mn\t164Ho\t\t84.510\t36.594\t121.103
53Sc\t182Lu\t\t93.651\t27.258\t120.908
52Sc\t183Lu\t\t94.085\t26.719\t120.803
51Sc\t184Lu\t\t94.411\t26.150\t120.562
63V\t172Tm\t\t88.041\t32.247\t120.288
59Ti\t176Yb\t\t89.916\t30.138\t120.054
50Sc\t185Lu\t\t93.976\t25.380\t119.356
54Sc\t181Lu\t\t91.908\t27.409\t119.317
68Cr\t167Er\t\t84.624\t34.464\t119.087
50Ca\t185Hf\t\t93.559\t25.270\t118.830
51Ca\t184Hf\t\t92.998\t25.763\t118.761
49Ca\t186Hf\t\t93.920\t24.725\t118.645
52Ca\t183Hf\t\t92.264\t26.205\t118.470
48Ca\t187Hf\t\t93.883\t24.079\t117.962
60Ti\t175Yb\t\t87.833\t30.112\t117.945
55Sc\t180Lu\t\t90.065\t27.511\t117.576
64V\t171Tm\t\t84.627\t31.676\t116.303
53Ca\t182Hf\t\t89.403\t26.027\t115.430
56Sc\t179Lu\t\t87.381\t27.332\t114.713
61Ti\t174Yb\t\t84.566\t29.648\t114.214
47Ca\t188Hf\t\t91.329\t22.814\t114.143
54Ca\t181Hf\t\t87.118\t25.986\t113.104
65V\t170Tm\t\t81.278\t31.083\t112.361
57Sc\t178Lu\t\t84.811\t27.156\t111.968
46Ca\t189Hf\t\t89.465\t21.756\t111.221
62Ti\t173Yb\t\t81.740\t29.298\t111.039
47K\t188Ta\t\t88.207\t22.038\t110.245
48K\t187Ta\t\t87.625\t22.480\t110.105
49K\t186Ta\t\t86.392\t22.750\t109.142
55Ca\t180Hf\t\t83.531\t25.522\t109.053
58Sc\t177Lu\t\t81.481\t26.701\t108.182
46K\t189Ta\t\t87.002\t21.161\t108.164
50K\t185Ta\t\t85.062\t22.983\t108.045
66V\t169Tm\t\t77.521\t30.283\t107.804
51K\t184Ta\t\t83.218\t23.061\t106.278
46Ar\t189W\t\t85.476\t20.793\t106.269
45K\t190Ta\t\t85.754\t20.296\t106.049
63Ti\t172Yb\t\t77.576\t28.422\t105.999
56Ca\t179Hf\t\t80.194\t25.090\t105.284
45Ar\t190W\t\t84.961\t20.112\t105.072
47Ar\t188W\t\t83.847\t20.954\t104.802
44Ar\t191W\t\t85.163\t19.607\t104.770
59Sc\t176Lu\t\t78.341\t26.266\t104.607
48Ar\t187W\t\t82.178\t21.088\t103.267
44K\t191Ta\t\t83.884\t19.310\t103.194
52K\t183Ta\t\t80.023\t22.737\t102.760
43Ar\t192W\t\t83.820\t18.760\t102.580
42Ar\t193W\t\t83.477\t18.153\t101.630
43K\t192Ta\t\t82.247\t18.406\t100.653
49Ar\t186W\t\t79.382\t20.910\t100.292
57Ca\t178Hf\t\t75.918\t24.315\t100.233
60Sc\t175Lu\t\t74.567\t25.573\t100.140
53K\t182Ta\t\t76.699\t22.336\t99.035
41Ar\t194W\t\t81.337\t17.177\t98.514
50Ar\t185W\t\t76.544\t20.687\t97.230
43Cl\t192Re\t\t79.120\t17.712\t96.832
42Cl\t193Re\t\t78.906\t17.163\t96.069
44Cl\t191Re\t\t77.935\t17.948\t95.882
58Ca\t177Hf\t\t72.092\t23.630\t95.723
61Sc\t174Lu\t\t70.749\t24.812\t95.561
41Cl\t194Re\t\t78.817\t16.648\t95.465
45Cl\t190Re\t\t76.744\t18.172\t94.915
54K\t181Ta\t\t72.678\t21.687\t94.364
40Cl\t195Re\t\t78.056\t16.002\t94.057
40S\t195Os\t\t77.400\t15.870\t93.270
39Cl\t196Re\t\t77.794\t15.469\t93.263
38S\t197Os\t\t78.045\t15.045\t93.091
46Cl\t189Re\t\t74.565\t18.146\t92.712
51Ar\t184W\t\t72.421\t20.076\t92.497
41S\t194Os\t\t76.256\t16.111\t92.366
39S\t196Os\t\t77.040\t15.322\t92.362
36S\t199Os\t\t77.974\t14.094\t92.068
42S\t193Os\t\t75.524\t16.431\t91.954
37S\t198Os\t\t77.231\t14.423\t91.654
38Cl\t197Re\t\t76.479\t14.742\t91.221
47Cl\t188Re\t\t72.030\t18.007\t90.037
37Cl\t198Re\t\t75.689\t14.132\t89.822
55K\t180Ta\t\t68.279\t20.870\t89.149
43S\t192Os\t\t72.716\t16.284\t89.000
35S\t200Os\t\t75.367\t13.179\t88.546
52Ar\t183W\t\t68.724\t19.533\t88.257
35P\t200Ir\t\t74.381\t13.008\t87.389
44S\t191Os\t\t70.322\t16.200\t86.522
48Cl\t187Re\t\t68.592\t17.609\t86.201
34S\t201Os\t\t73.645\t12.447\t86.092
37P\t198Ir\t\t72.243\t13.494\t85.738
36P\t199Ir\t\t72.468\t13.104\t85.572
34P\t201Ir\t\t73.022\t12.344\t85.366
32Si\t203Pt\t\t73.109\t11.516\t84.625
34Si\t201Pt\t\t72.381\t12.237\t84.618
33Si\t202Pt\t\t72.319\t11.808\t84.127
33P\t202Ir\t\t72.241\t11.793\t84.034
38P\t197Ir\t\t70.299\t13.557\t83.856
45S\t190Os\t\t67.606\t16.014\t83.620
56K\t179Ta\t\t63.484\t19.870\t83.353
39P\t196Ir\t\t69.384\t13.803\t83.188
53Ar\t182W\t\t63.793\t18.585\t82.378
35Si\t200Pt\t\t69.690\t12.192\t81.882
31Si\t204Pt\t\t71.009\t10.783\t81.792
49Cl\t186Re\t\t64.665\t17.040\t81.706
36Si\t199Pt\t\t68.343\t12.361\t80.704
40P\t195Ir\t\t66.956\t13.734\t80.689
33S\t202Os\t\t69.284\t11.310\t80.594
32P\t203Ir\t\t69.040\t10.875\t79.915
46S\t189Os\t\t64.235\t15.637\t79.872
41P\t194Ir\t\t64.749\t13.685\t78.434
30Si\t205Pt\t\t68.329\t9.991\t78.320
37Si\t198Pt\t\t65.231\t12.189\t77.421
31Al\t204Au\t\t66.435\t10.091\t76.526
50Cl\t185Re\t\t60.071\t16.242\t76.313
30Al\t205Au\t\t65.920\t9.642\t75.563
38Si\t197Pt\t\t63.302\t12.211\t75.513
32Al\t203Au\t\t64.930\t10.233\t75.163
31P\t204Ir\t\t65.156\t9.893\t75.049
47S\t188Os\t\t59.719\t14.936\t74.655
42P\t193Ir\t\t61.141\t13.308\t74.449
33Al\t202Au\t\t63.388\t10.354\t73.742
29Al\t206Au\t\t64.294\t9.046\t73.340
29Mg\t206Hg\t\t63.528\t8.941\t72.469
29Si\t206Pt\t\t63.513\t8.934\t72.447
28Mg\t207Hg\t\t63.801\t8.626\t72.427
30Mg\t205Hg\t\t62.890\t9.202\t72.092
39Si\t196Pt\t\t59.421\t11.826\t71.247
43P\t192Ir\t\t58.069\t13.009\t71.078
51Cl\t184Re\t\t55.326\t15.344\t70.670
34Al\t201Au\t\t60.206\t10.185\t70.390
48S\t187Os\t\t55.203\t14.177\t69.380
27Mg\t208Hg\t\t60.875\t7.898\t68.773
31Mg\t204Hg\t\t59.666\t9.067\t68.733
28Al\t207Au\t\t60.410\t8.167\t68.577
35Al\t200Au\t\t58.195\t10.186\t68.381
40Si\t195Pt\t\t56.661\t11.627\t68.287
44P\t191Ir\t\t54.605\t12.585\t67.189
32Mg\t203Hg\t\t57.892\t9.127\t67.018
26Mg\t209Hg\t\t58.506\t7.274\t65.779
27Al\t208Au\t\t56.845\t7.374\t64.219
36Al\t199Au\t\t54.248\t9.817\t64.065
41Si\t194Pt\t\t52.469\t11.094\t63.564
33Mg\t202Hg\t\t54.412\t8.892\t63.304
27Na\t208Tl\t\t55.929\t7.259\t63.188
28Na\t207Tl\t\t55.442\t7.500\t62.942
49S\t186Os\t\t49.635\t13.085\t62.720
45P\t190Ir\t\t50.408\t11.946\t62.353
26Na\t209Tl\t\t54.625\t6.794\t61.419
37Al\t198Au\t\t51.134\t9.560\t60.693
29Na\t206Tl\t\t53.027\t7.467\t60.494
34Mg\t201Hg\t\t51.539\t8.722\t60.260
25Na\t210Tl\t\t53.194\t6.330\t59.525
25Mg\t210Hg\t\t53.154\t6.324\t59.479
42Si\t193Pt\t\t48.319\t10.521\t58.840
26Ne\t209Pb\t\t51.632\t6.424\t58.055
25Ne\t210Pb\t\t51.569\t6.139\t57.708
24Ne\t211Pb\t\t51.506\t5.857\t57.364
46P\t189Ir\t\t45.509\t11.084\t56.593
30Na\t205Tl\t\t49.081\t7.186\t56.266
38Al\t197Au\t\t46.816\t9.036\t55.852
27Ne\t208Pb\t\t49.239\t6.394\t55.633
26Al\t209Au\t\t49.451\t6.149\t55.599
24Mg\t211Hg\t\t49.816\t5.663\t55.478
24Na\t211Tl\t\t49.759\t5.658\t55.417
35Mg\t200Hg\t\t46.621\t8.164\t54.784
43Si\t192Pt\t\t44.204\t9.908\t54.112
23Ne\t212Pb\t\t48.375\t5.247\t53.622
31Na\t204Tl\t\t46.010\t6.996\t53.005
22Ne\t213Pb\t\t47.267\t4.880\t52.147
28Ne\t207Pb\t\t45.872\t6.208\t52.081
23Na\t212Tl\t\t46.914\t5.087\t52.001
39Al\t196Au\t\t42.585\t8.480\t51.065
36Mg\t199Hg\t\t42.409\t7.678\t50.087
47P\t188Ir\t\t40.019\t10.014\t50.032
44Si\t191Pt\t\t39.095\t9.014\t48.109
32Na\t203Tl\t\t41.349\t6.523\t47.872
25Al\t210Au\t\t42.456\t5.052\t47.508
21Ne\t214Pb\t\t42.649\t4.184\t46.833
29Ne\t206Pb\t\t40.588\t5.718\t46.306
23F\t212Bi\t\t41.249\t4.476\t45.725
40Al\t195Au\t\t37.764\t7.754\t45.517
24F\t211Bi\t\t40.599\t4.620\t45.219
25F\t210Bi\t\t39.628\t4.720\t44.349
22Na\t213Tl\t\t40.170\t4.148\t44.318
23Mg\t212Hg\t\t39.367\t4.270\t43.637
37Mg\t198Hg\t\t36.718\t6.868\t43.586
20Ne\t215Pb\t\t39.842\t3.705\t43.546
22F\t213Bi\t\t39.298\t4.060\t43.358
33Na\t202Tl\t\t36.905\t6.035\t42.940
21F\t214Bi\t\t38.400\t3.768\t42.168
30Ne\t205Pb\t\t36.329\t5.322\t41.651
45Si\t190Pt\t\t33.168\t7.864\t41.033
26F\t209Bi\t\t36.028\t4.486\t40.514
20F\t215Bi\t\t35.946\t3.344\t39.290
41Al\t194Au\t\t32.393\t6.853\t39.246
22O\t213Po\t\t34.704\t3.586\t38.290
20O\t215Po\t\t34.459\t3.206\t37.665
38Mg\t197Hg\t\t31.336\t6.051\t37.388
21O\t214Po\t\t33.991\t3.337\t37.328
34Na\t201Tl\t\t31.480\t5.331\t36.811
23O\t212Po\t\t33.078\t3.591\t36.669
21Na\t214Tl\t\t33.367\t3.274\t36.641
19F\t216Bi\t\t33.581\t2.954\t36.534
18O\t217Po\t\t33.075\t2.743\t35.818
19O\t216Po\t\t32.909\t2.895\t35.804
31Ne\t204Pb\t\t30.560\t4.650\t35.210
27F\t208Bi\t\t31.117\t4.044\t35.161
24O\t211Po\t\t31.290\t3.562\t34.852
22Mg\t213Hg\t\t30.504\t3.150\t33.654
42Al\t193Au\t\t27.498\t5.991\t33.490
17O\t218Po\t\t30.957\t2.414\t33.371
16O\t219Po\t\t30.732\t2.244\t32.976
19Ne\t216Pb\t\t29.126\t2.562\t31.689
18F\t217Bi\t\t28.919\t2.399\t31.318
39Mg\t196Hg\t\t25.410\t5.063\t30.472
35Na\t200Tl\t\t25.636\t4.492\t30.128
25O\t210Po\t\t26.381\t3.145\t29.526
32Ne\t203Pb\t\t24.794\t3.914\t28.708
28F\t207Bi\t\t24.707\t3.347\t28.054
15N\t220At\t\t24.756\t1.688\t26.443
17F\t218Bi\t\t23.890\t1.863\t25.753
43Al\t192Au\t\t21.035\t4.717\t25.752
17N\t218At\t\t23.146\t1.806\t24.951
16N\t219At\t\t23.148\t1.692\t24.840
20Na\t215Tl\t\t22.102\t2.057\t24.159
14C\t221Rn\t\t22.032\t1.396\t23.428
18N\t217At\t\t21.617\t1.794\t23.412
18Ne\t217Pb\t\t21.573\t1.790\t23.363
40Mg\t195Hg\t\t19.342\t3.973\t23.315
36Na\t199Tl\t\t19.530\t3.538\t23.069
19N\t216At\t\t20.962\t1.846\t22.808
15O\t220Po\t\t21.346\t1.456\t22.802
26O\t209Po\t\t20.055\t2.499\t22.553
13C\t222Rn\t\t20.236\t1.185\t21.422
29F\t206Bi\t\t18.688\t2.635\t21.323
14N\t221At\t\t20.007\t1.268\t21.275
33Ne\t202Pb\t\t17.930\t2.934\t20.864
12C\t223Rn\t\t19.483\t1.048\t20.531
15C\t220Rn\t\t19.129\t1.305\t20.434
20N\t215At\t\t18.671\t1.739\t20.410
21N\t214At\t\t17.345\t1.704\t19.049
21Mg\t214Hg\t\t17.146\t1.683\t18.829
16C\t219Rn\t\t17.142\t1.253\t18.396
22N\t213At\t\t14.012\t1.450\t15.461
37Na\t198Tl\t\t12.865\t2.408\t15.273
17C\t218Rn\t\t13.609\t1.063\t14.672
13N\t222At\t\t13.813\t0.809\t14.622
16F\t219Bi\t\t13.007\t0.951\t13.958
27O\t208Po\t\t12.335\t1.604\t13.939
30F\t205Bi\t\t12.099\t1.774\t13.873
34Ne\t201Pb\t\t11.405\t1.933\t13.338
19Na\t216Tl\t\t12.200\t1.074\t13.274
14O\t221Po\t\t12.356\t0.783\t13.139
18C\t217Rn\t\t11.397\t0.947\t12.344
23N\t212At\t\t10.126\t1.101\t11.227
11B\t224Fr\t\t9.968\t0.490\t10.458
12B\t223Fr\t\t8.699\t0.469\t9.167
17Ne\t218Pb\t\t8.317\t0.649\t8.967
8Be\t227Ra\t\t8.500\t0.300\t8.800
19C\t216Rn\t\t7.586\t0.669\t8.255
13B\t222Fr\t\t7.565\t0.444\t8.009
11C\t224Rn\t\t7.459\t0.367\t7.825
20Mg\t215Hg\t\t6.545\t0.609\t7.154
10Be\t225Ra\t\t6.050\t0.269\t6.319
28O\t207Po\t\t5.272\t0.715\t5.986
31F\t204Bi\t\t5.162\t0.786\t5.948
9Be\t226Ra\t\t5.676\t0.226\t5.903
24N\t211At\t\t5.053\t0.576\t5.630
10B\t225Fr\t\t4.834\t0.215\t5.049
4He\t231Th\t\t4.599\t0.080\t4.678
20C\t215Rn\t\t4.145\t0.386\t4.531
14B\t221Fr\t\t3.741\t0.237\t3.978
15F\t220Bi\t\t3.084\t0.211\t3.295
11Be\t224Ra\t\t1.826\t0.090\t1.916
9B\t226Fr\t\t0.927\t0.037\t0.964
15B\t220Fr\t\t0.449\t0.031\t0.479
12N\t223At\t\t0.147\t0.008\t0.155"""
    assert expOut == out


def test_pEmission():
    argv = ['--pEmission', '151Lu']
    out = get_output(argv)
    expOut = """1(1H)\t150Yb\t\t1.241"""
    assert expOut == out


def test_double_pEmission():
    argv = ['--pEmission', '--num', '2', '45Fe']
    out = get_output(argv)
    expOut = """2(1H)\t43Cr\t\t1.154"""
    assert expOut == out


def test_nEmission():
    argv = ['--nEmission', '13Be']
    out = get_output(argv)
    expOut = """1(1n)\t12Be\t\t0.510"""
    assert expOut == out


def test_compton():
    argv = ['--compton', '-v', 'n']
    out = get_output(argv)
    expOut = """#The compton wavelength in fm
1.3195908515350636"""
    assert expOut == out
